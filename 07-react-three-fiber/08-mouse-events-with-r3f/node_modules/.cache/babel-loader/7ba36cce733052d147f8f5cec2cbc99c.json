{"ast":null,"code":"import _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\n/**\n * @webxr-input-profiles/motion-controllers 1.0.0 https://github.com/immersive-web/webxr-input-profiles\n */\n\nconst MotionControllerConstants = {\n  Handedness: Object.freeze({\n    NONE: 'none',\n    LEFT: 'left',\n    RIGHT: 'right'\n  }),\n  ComponentState: Object.freeze({\n    DEFAULT: 'default',\n    TOUCHED: 'touched',\n    PRESSED: 'pressed'\n  }),\n  ComponentProperty: Object.freeze({\n    BUTTON: 'button',\n    X_AXIS: 'xAxis',\n    Y_AXIS: 'yAxis',\n    STATE: 'state'\n  }),\n  ComponentType: Object.freeze({\n    TRIGGER: 'trigger',\n    SQUEEZE: 'squeeze',\n    TOUCHPAD: 'touchpad',\n    THUMBSTICK: 'thumbstick',\n    BUTTON: 'button'\n  }),\n  ButtonTouchThreshold: 0.05,\n  AxisTouchThreshold: 0.1,\n  VisualResponseProperty: Object.freeze({\n    TRANSFORM: 'transform',\n    VISIBILITY: 'visibility'\n  })\n};\n/**\n * @description Static helper function to fetch a JSON file and turn it into a JS object\n * @param {string} path - Path to JSON file to be fetched\n */\n\nasync function fetchJsonFile(path) {\n  const response = await fetch(path);\n\n  if (!response.ok) {\n    throw new Error(response.statusText);\n  } else {\n    return response.json();\n  }\n}\n\nasync function fetchProfilesList(basePath) {\n  if (!basePath) {\n    throw new Error('No basePath supplied');\n  }\n\n  const profileListFileName = 'profilesList.json';\n  const profilesList = await fetchJsonFile(`${basePath}/${profileListFileName}`);\n  return profilesList;\n}\n\nasync function fetchProfile(xrInputSource, basePath) {\n  let defaultProfile = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  let getAssetPath = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : true;\n\n  if (!xrInputSource) {\n    throw new Error('No xrInputSource supplied');\n  }\n\n  if (!basePath) {\n    throw new Error('No basePath supplied');\n  } // Get the list of profiles\n\n\n  const supportedProfilesList = await fetchProfilesList(basePath); // Find the relative path to the first requested profile that is recognized\n\n  let match = undefined;\n  xrInputSource.profiles.some(profileId => {\n    const supportedProfile = supportedProfilesList[profileId];\n\n    if (supportedProfile) {\n      match = {\n        profileId,\n        profilePath: `${basePath}/${supportedProfile.path}`,\n        deprecated: !!supportedProfile.deprecated\n      };\n    }\n\n    return !!match;\n  });\n\n  if (!match) {\n    if (!defaultProfile) {\n      throw new Error('No matching profile name found');\n    }\n\n    const supportedProfile = supportedProfilesList[defaultProfile];\n\n    if (!supportedProfile) {\n      throw new Error(`No matching profile name found and default profile \"${defaultProfile}\" missing.`);\n    }\n\n    match = {\n      profileId: defaultProfile,\n      profilePath: `${basePath}/${supportedProfile.path}`,\n      deprecated: !!supportedProfile.deprecated\n    };\n  }\n\n  const profile = await fetchJsonFile(match.profilePath);\n  let assetPath = undefined;\n\n  if (getAssetPath) {\n    let layout;\n\n    if (xrInputSource.handedness === 'any') {\n      layout = profile.layouts[Object.keys(profile.layouts)[0]];\n    } else {\n      layout = profile.layouts[xrInputSource.handedness];\n    }\n\n    if (!layout) {\n      throw new Error(`No matching handedness, ${xrInputSource.handedness}, in profile ${match.profileId}`);\n    }\n\n    if (layout.assetPath) {\n      assetPath = match.profilePath.replace('profile.json', layout.assetPath);\n    }\n  }\n\n  return {\n    profile,\n    assetPath\n  };\n}\n/** @constant {Object} */\n\n\nconst defaultComponentValues = {\n  xAxis: 0,\n  yAxis: 0,\n  button: 0,\n  state: MotionControllerConstants.ComponentState.DEFAULT\n};\n/**\n * @description Converts an X, Y coordinate from the range -1 to 1 (as reported by the Gamepad\n * API) to the range 0 to 1 (for interpolation). Also caps the X, Y values to be bounded within\n * a circle. This ensures that thumbsticks are not animated outside the bounds of their physical\n * range of motion and touchpads do not report touch locations off their physical bounds.\n * @param {number | undefined} x The original x coordinate in the range -1 to 1\n * @param {number | undefined} y The original y coordinate in the range -1 to 1\n */\n\nfunction normalizeAxes() {\n  let x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  let y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  let xAxis = x;\n  let yAxis = y; // Determine if the point is outside the bounds of the circle\n  // and, if so, place it on the edge of the circle\n\n  const hypotenuse = Math.sqrt(x * x + y * y);\n\n  if (hypotenuse > 1) {\n    const theta = Math.atan2(y, x);\n    xAxis = Math.cos(theta);\n    yAxis = Math.sin(theta);\n  } // Scale and move the circle so values are in the interpolation range.  The circle's origin moves\n  // from (0, 0) to (0.5, 0.5). The circle's radius scales from 1 to be 0.5.\n\n\n  const result = {\n    normalizedXAxis: xAxis * 0.5 + 0.5,\n    normalizedYAxis: yAxis * 0.5 + 0.5\n  };\n  return result;\n}\n/**\n * Contains the description of how the 3D model should visually respond to a specific user input.\n * This is accomplished by initializing the object with the name of a node in the 3D model and\n * property that need to be modified in response to user input, the name of the nodes representing\n * the allowable range of motion, and the name of the input which triggers the change. In response\n * to the named input changing, this object computes the appropriate weighting to use for\n * interpolating between the range of motion nodes.\n */\n\n\nclass VisualResponse {\n  constructor(visualResponseDescription) {\n    _defineProperty(this, \"value\", void 0);\n\n    _defineProperty(this, \"componentProperty\", void 0);\n\n    _defineProperty(this, \"states\", void 0);\n\n    _defineProperty(this, \"valueNodeName\", void 0);\n\n    _defineProperty(this, \"valueNodeProperty\", void 0);\n\n    _defineProperty(this, \"minNodeName\", void 0);\n\n    _defineProperty(this, \"maxNodeName\", void 0);\n\n    _defineProperty(this, \"valueNode\", void 0);\n\n    _defineProperty(this, \"minNode\", void 0);\n\n    _defineProperty(this, \"maxNode\", void 0);\n\n    this.componentProperty = visualResponseDescription.componentProperty;\n    this.states = visualResponseDescription.states;\n    this.valueNodeName = visualResponseDescription.valueNodeName;\n    this.valueNodeProperty = visualResponseDescription.valueNodeProperty;\n\n    if (this.valueNodeProperty === MotionControllerConstants.VisualResponseProperty.TRANSFORM) {\n      this.minNodeName = visualResponseDescription.minNodeName;\n      this.maxNodeName = visualResponseDescription.maxNodeName;\n    } // Initializes the response's current value based on default data\n\n\n    this.value = 0;\n    this.updateFromComponent(defaultComponentValues);\n  }\n  /**\n   * Computes the visual response's interpolation weight based on component state\n   * @param {Object} componentValues - The component from which to update\n   * @param {number | undefined} xAxis - The reported X axis value of the component\n   * @param {number | undefined} yAxis - The reported Y axis value of the component\n   * @param {number | undefined} button - The reported value of the component's button\n   * @param {string} state - The component's active state\n   */\n\n\n  updateFromComponent(_ref) {\n    let {\n      xAxis,\n      yAxis,\n      button,\n      state\n    } = _ref;\n    const {\n      normalizedXAxis,\n      normalizedYAxis\n    } = normalizeAxes(xAxis, yAxis);\n\n    switch (this.componentProperty) {\n      case MotionControllerConstants.ComponentProperty.X_AXIS:\n        this.value = this.states.includes(state) ? normalizedXAxis : 0.5;\n        break;\n\n      case MotionControllerConstants.ComponentProperty.Y_AXIS:\n        this.value = this.states.includes(state) ? normalizedYAxis : 0.5;\n        break;\n\n      case MotionControllerConstants.ComponentProperty.BUTTON:\n        this.value = this.states.includes(state) && button ? button : 0;\n        break;\n\n      case MotionControllerConstants.ComponentProperty.STATE:\n        if (this.valueNodeProperty === MotionControllerConstants.VisualResponseProperty.VISIBILITY) {\n          this.value = this.states.includes(state);\n        } else {\n          this.value = this.states.includes(state) ? 1.0 : 0.0;\n        }\n\n        break;\n\n      default:\n        throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`);\n    }\n  }\n\n}\n\nclass Component {\n  /**\n   * @param {string} componentId - Id of the component\n   * @param {InputProfileComponent} componentDescription - Description of the component to be created\n   */\n  constructor(componentId, componentDescription) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"values\", void 0);\n\n    _defineProperty(this, \"type\", void 0);\n\n    _defineProperty(this, \"gamepadIndices\", void 0);\n\n    _defineProperty(this, \"rootNodeName\", void 0);\n\n    _defineProperty(this, \"visualResponses\", void 0);\n\n    _defineProperty(this, \"touchPointNodeName\", void 0);\n\n    _defineProperty(this, \"touchPointNode\", void 0);\n\n    if (!componentId || !componentDescription || !componentDescription.visualResponses || !componentDescription.gamepadIndices || Object.keys(componentDescription.gamepadIndices).length === 0) {\n      throw new Error('Invalid arguments supplied');\n    }\n\n    this.id = componentId;\n    this.type = componentDescription.type;\n    this.rootNodeName = componentDescription.rootNodeName;\n    this.touchPointNodeName = componentDescription.touchPointNodeName; // Build all the visual responses for this component\n\n    this.visualResponses = {};\n    Object.keys(componentDescription.visualResponses).forEach(responseName => {\n      const visualResponse = new VisualResponse(componentDescription.visualResponses[responseName]);\n      this.visualResponses[responseName] = visualResponse;\n    }); // Set default values\n\n    this.gamepadIndices = Object.assign({}, componentDescription.gamepadIndices);\n    this.values = {\n      state: MotionControllerConstants.ComponentState.DEFAULT,\n      button: this.gamepadIndices.button !== undefined ? 0 : undefined,\n      xAxis: this.gamepadIndices.xAxis !== undefined ? 0 : undefined,\n      yAxis: this.gamepadIndices.yAxis !== undefined ? 0 : undefined\n    };\n  }\n\n  get data() {\n    const data = {\n      id: this.id,\n      ...this.values\n    };\n    return data;\n  }\n  /**\n   * @description Poll for updated data based on current gamepad state\n   * @param {Object} gamepad - The gamepad object from which the component data should be polled\n   */\n\n\n  updateFromGamepad(gamepad) {\n    // Set the state to default before processing other data sources\n    this.values.state = MotionControllerConstants.ComponentState.DEFAULT; // Get and normalize button\n\n    if (this.gamepadIndices.button !== undefined && gamepad.buttons.length > this.gamepadIndices.button) {\n      const gamepadButton = gamepad.buttons[this.gamepadIndices.button];\n      this.values.button = gamepadButton.value;\n      this.values.button = this.values.button < 0 ? 0 : this.values.button;\n      this.values.button = this.values.button > 1 ? 1 : this.values.button; // Set the state based on the button\n\n      if (gamepadButton.pressed || this.values.button === 1) {\n        this.values.state = MotionControllerConstants.ComponentState.PRESSED;\n      } else if (gamepadButton.touched || this.values.button > MotionControllerConstants.ButtonTouchThreshold) {\n        this.values.state = MotionControllerConstants.ComponentState.TOUCHED;\n      }\n    } // Get and normalize x axis value\n\n\n    if (this.gamepadIndices.xAxis !== undefined && gamepad.axes.length > this.gamepadIndices.xAxis) {\n      this.values.xAxis = gamepad.axes[this.gamepadIndices.xAxis];\n      this.values.xAxis = this.values.xAxis < -1 ? -1 : this.values.xAxis;\n      this.values.xAxis = this.values.xAxis > 1 ? 1 : this.values.xAxis; // If the state is still default, check if the xAxis makes it touched\n\n      if (this.values.state === MotionControllerConstants.ComponentState.DEFAULT && Math.abs(this.values.xAxis) > MotionControllerConstants.AxisTouchThreshold) {\n        this.values.state = MotionControllerConstants.ComponentState.TOUCHED;\n      }\n    } // Get and normalize Y axis value\n\n\n    if (this.gamepadIndices.yAxis !== undefined && gamepad.axes.length > this.gamepadIndices.yAxis) {\n      this.values.yAxis = gamepad.axes[this.gamepadIndices.yAxis];\n      this.values.yAxis = this.values.yAxis < -1 ? -1 : this.values.yAxis;\n      this.values.yAxis = this.values.yAxis > 1 ? 1 : this.values.yAxis; // If the state is still default, check if the yAxis makes it touched\n\n      if (this.values.state === MotionControllerConstants.ComponentState.DEFAULT && Math.abs(this.values.yAxis) > MotionControllerConstants.AxisTouchThreshold) {\n        this.values.state = MotionControllerConstants.ComponentState.TOUCHED;\n      }\n    } // Update the visual response weights based on the current component data\n\n\n    Object.values(this.visualResponses).forEach(visualResponse => {\n      visualResponse.updateFromComponent(this.values);\n    });\n  }\n\n}\n/**\n * @description Builds a motion controller with components and visual responses based on the\n * supplied profile description. Data is polled from the xrInputSource's gamepad.\n * @author Nell Waliczek / https://github.com/NellWaliczek\n */\n\n\nclass MotionController {\n  /**\n   * @param {XRInputSource} xrInputSource - The XRInputSource to build the MotionController around\n   * @param {Profile} profile - The best matched profile description for the supplied xrInputSource\n   * @param {string} assetUrl\n   */\n  constructor(xrInputSource, profile, assetUrl) {\n    _defineProperty(this, \"xrInputSource\", void 0);\n\n    _defineProperty(this, \"assetUrl\", void 0);\n\n    _defineProperty(this, \"layoutDescription\", void 0);\n\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"components\", void 0);\n\n    if (!xrInputSource) {\n      throw new Error('No xrInputSource supplied');\n    }\n\n    if (!profile) {\n      throw new Error('No profile supplied');\n    }\n\n    if (!profile.layouts[xrInputSource.handedness]) {\n      throw new Error('No layout for ' + xrInputSource.handedness + ' handedness');\n    }\n\n    this.xrInputSource = xrInputSource;\n    this.assetUrl = assetUrl;\n    this.id = profile.profileId; // Build child components as described in the profile description\n\n    this.layoutDescription = profile.layouts[xrInputSource.handedness];\n    this.components = {};\n    Object.keys(this.layoutDescription.components).forEach(componentId => {\n      const componentDescription = this.layoutDescription.components[componentId];\n      this.components[componentId] = new Component(componentId, componentDescription);\n    }); // Initialize components based on current gamepad state\n\n    this.updateFromGamepad();\n  }\n\n  get gripSpace() {\n    return this.xrInputSource.gripSpace;\n  }\n\n  get targetRaySpace() {\n    return this.xrInputSource.targetRaySpace;\n  }\n  /**\n   * @description Returns a subset of component data for simplified debugging\n   */\n\n\n  get data() {\n    const data = [];\n    Object.values(this.components).forEach(component => {\n      data.push(component.data);\n    });\n    return data;\n  }\n  /**\n   * @description Poll for updated data based on current gamepad state\n   */\n\n\n  updateFromGamepad() {\n    Object.values(this.components).forEach(component => {\n      component.updateFromGamepad(this.xrInputSource.gamepad);\n    });\n  }\n\n}\n\nexport { MotionController, MotionControllerConstants, fetchProfile, fetchProfilesList };","map":{"version":3,"names":["_defineProperty","MotionControllerConstants","Handedness","Object","freeze","NONE","LEFT","RIGHT","ComponentState","DEFAULT","TOUCHED","PRESSED","ComponentProperty","BUTTON","X_AXIS","Y_AXIS","STATE","ComponentType","TRIGGER","SQUEEZE","TOUCHPAD","THUMBSTICK","ButtonTouchThreshold","AxisTouchThreshold","VisualResponseProperty","TRANSFORM","VISIBILITY","fetchJsonFile","path","response","fetch","ok","Error","statusText","json","fetchProfilesList","basePath","profileListFileName","profilesList","fetchProfile","xrInputSource","defaultProfile","getAssetPath","supportedProfilesList","match","undefined","profiles","some","profileId","supportedProfile","profilePath","deprecated","profile","assetPath","layout","handedness","layouts","keys","replace","defaultComponentValues","xAxis","yAxis","button","state","normalizeAxes","x","y","hypotenuse","Math","sqrt","theta","atan2","cos","sin","result","normalizedXAxis","normalizedYAxis","VisualResponse","constructor","visualResponseDescription","componentProperty","states","valueNodeName","valueNodeProperty","minNodeName","maxNodeName","value","updateFromComponent","includes","Component","componentId","componentDescription","visualResponses","gamepadIndices","length","id","type","rootNodeName","touchPointNodeName","forEach","responseName","visualResponse","assign","values","data","updateFromGamepad","gamepad","buttons","gamepadButton","pressed","touched","axes","abs","MotionController","assetUrl","layoutDescription","components","gripSpace","targetRaySpace","component","push"],"sources":["/home/rodrigorvsn/workspace/study/threejs-journey/07-react-three-fiber/08-mouse-events-with-r3f/node_modules/three-stdlib/libs/MotionControllers.js"],"sourcesContent":["import _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\n\n/**\n * @webxr-input-profiles/motion-controllers 1.0.0 https://github.com/immersive-web/webxr-input-profiles\n */\nconst MotionControllerConstants = {\n  Handedness: Object.freeze({\n    NONE: 'none',\n    LEFT: 'left',\n    RIGHT: 'right'\n  }),\n  ComponentState: Object.freeze({\n    DEFAULT: 'default',\n    TOUCHED: 'touched',\n    PRESSED: 'pressed'\n  }),\n  ComponentProperty: Object.freeze({\n    BUTTON: 'button',\n    X_AXIS: 'xAxis',\n    Y_AXIS: 'yAxis',\n    STATE: 'state'\n  }),\n  ComponentType: Object.freeze({\n    TRIGGER: 'trigger',\n    SQUEEZE: 'squeeze',\n    TOUCHPAD: 'touchpad',\n    THUMBSTICK: 'thumbstick',\n    BUTTON: 'button'\n  }),\n  ButtonTouchThreshold: 0.05,\n  AxisTouchThreshold: 0.1,\n  VisualResponseProperty: Object.freeze({\n    TRANSFORM: 'transform',\n    VISIBILITY: 'visibility'\n  })\n};\n/**\n * @description Static helper function to fetch a JSON file and turn it into a JS object\n * @param {string} path - Path to JSON file to be fetched\n */\n\nasync function fetchJsonFile(path) {\n  const response = await fetch(path);\n\n  if (!response.ok) {\n    throw new Error(response.statusText);\n  } else {\n    return response.json();\n  }\n}\n\nasync function fetchProfilesList(basePath) {\n  if (!basePath) {\n    throw new Error('No basePath supplied');\n  }\n\n  const profileListFileName = 'profilesList.json';\n  const profilesList = await fetchJsonFile(`${basePath}/${profileListFileName}`);\n  return profilesList;\n}\n\nasync function fetchProfile(xrInputSource, basePath, defaultProfile = null, getAssetPath = true) {\n  if (!xrInputSource) {\n    throw new Error('No xrInputSource supplied');\n  }\n\n  if (!basePath) {\n    throw new Error('No basePath supplied');\n  } // Get the list of profiles\n\n\n  const supportedProfilesList = await fetchProfilesList(basePath); // Find the relative path to the first requested profile that is recognized\n\n  let match = undefined;\n  xrInputSource.profiles.some(profileId => {\n    const supportedProfile = supportedProfilesList[profileId];\n\n    if (supportedProfile) {\n      match = {\n        profileId,\n        profilePath: `${basePath}/${supportedProfile.path}`,\n        deprecated: !!supportedProfile.deprecated\n      };\n    }\n\n    return !!match;\n  });\n\n  if (!match) {\n    if (!defaultProfile) {\n      throw new Error('No matching profile name found');\n    }\n\n    const supportedProfile = supportedProfilesList[defaultProfile];\n\n    if (!supportedProfile) {\n      throw new Error(`No matching profile name found and default profile \"${defaultProfile}\" missing.`);\n    }\n\n    match = {\n      profileId: defaultProfile,\n      profilePath: `${basePath}/${supportedProfile.path}`,\n      deprecated: !!supportedProfile.deprecated\n    };\n  }\n\n  const profile = await fetchJsonFile(match.profilePath);\n  let assetPath = undefined;\n\n  if (getAssetPath) {\n    let layout;\n\n    if (xrInputSource.handedness === 'any') {\n      layout = profile.layouts[Object.keys(profile.layouts)[0]];\n    } else {\n      layout = profile.layouts[xrInputSource.handedness];\n    }\n\n    if (!layout) {\n      throw new Error(`No matching handedness, ${xrInputSource.handedness}, in profile ${match.profileId}`);\n    }\n\n    if (layout.assetPath) {\n      assetPath = match.profilePath.replace('profile.json', layout.assetPath);\n    }\n  }\n\n  return {\n    profile,\n    assetPath\n  };\n}\n/** @constant {Object} */\n\n\nconst defaultComponentValues = {\n  xAxis: 0,\n  yAxis: 0,\n  button: 0,\n  state: MotionControllerConstants.ComponentState.DEFAULT\n};\n/**\n * @description Converts an X, Y coordinate from the range -1 to 1 (as reported by the Gamepad\n * API) to the range 0 to 1 (for interpolation). Also caps the X, Y values to be bounded within\n * a circle. This ensures that thumbsticks are not animated outside the bounds of their physical\n * range of motion and touchpads do not report touch locations off their physical bounds.\n * @param {number | undefined} x The original x coordinate in the range -1 to 1\n * @param {number | undefined} y The original y coordinate in the range -1 to 1\n */\n\nfunction normalizeAxes(x = 0, y = 0) {\n  let xAxis = x;\n  let yAxis = y; // Determine if the point is outside the bounds of the circle\n  // and, if so, place it on the edge of the circle\n\n  const hypotenuse = Math.sqrt(x * x + y * y);\n\n  if (hypotenuse > 1) {\n    const theta = Math.atan2(y, x);\n    xAxis = Math.cos(theta);\n    yAxis = Math.sin(theta);\n  } // Scale and move the circle so values are in the interpolation range.  The circle's origin moves\n  // from (0, 0) to (0.5, 0.5). The circle's radius scales from 1 to be 0.5.\n\n\n  const result = {\n    normalizedXAxis: xAxis * 0.5 + 0.5,\n    normalizedYAxis: yAxis * 0.5 + 0.5\n  };\n  return result;\n}\n/**\n * Contains the description of how the 3D model should visually respond to a specific user input.\n * This is accomplished by initializing the object with the name of a node in the 3D model and\n * property that need to be modified in response to user input, the name of the nodes representing\n * the allowable range of motion, and the name of the input which triggers the change. In response\n * to the named input changing, this object computes the appropriate weighting to use for\n * interpolating between the range of motion nodes.\n */\n\n\nclass VisualResponse {\n  constructor(visualResponseDescription) {\n    _defineProperty(this, \"value\", void 0);\n\n    _defineProperty(this, \"componentProperty\", void 0);\n\n    _defineProperty(this, \"states\", void 0);\n\n    _defineProperty(this, \"valueNodeName\", void 0);\n\n    _defineProperty(this, \"valueNodeProperty\", void 0);\n\n    _defineProperty(this, \"minNodeName\", void 0);\n\n    _defineProperty(this, \"maxNodeName\", void 0);\n\n    _defineProperty(this, \"valueNode\", void 0);\n\n    _defineProperty(this, \"minNode\", void 0);\n\n    _defineProperty(this, \"maxNode\", void 0);\n\n    this.componentProperty = visualResponseDescription.componentProperty;\n    this.states = visualResponseDescription.states;\n    this.valueNodeName = visualResponseDescription.valueNodeName;\n    this.valueNodeProperty = visualResponseDescription.valueNodeProperty;\n\n    if (this.valueNodeProperty === MotionControllerConstants.VisualResponseProperty.TRANSFORM) {\n      this.minNodeName = visualResponseDescription.minNodeName;\n      this.maxNodeName = visualResponseDescription.maxNodeName;\n    } // Initializes the response's current value based on default data\n\n\n    this.value = 0;\n    this.updateFromComponent(defaultComponentValues);\n  }\n  /**\n   * Computes the visual response's interpolation weight based on component state\n   * @param {Object} componentValues - The component from which to update\n   * @param {number | undefined} xAxis - The reported X axis value of the component\n   * @param {number | undefined} yAxis - The reported Y axis value of the component\n   * @param {number | undefined} button - The reported value of the component's button\n   * @param {string} state - The component's active state\n   */\n\n\n  updateFromComponent({\n    xAxis,\n    yAxis,\n    button,\n    state\n  }) {\n    const {\n      normalizedXAxis,\n      normalizedYAxis\n    } = normalizeAxes(xAxis, yAxis);\n\n    switch (this.componentProperty) {\n      case MotionControllerConstants.ComponentProperty.X_AXIS:\n        this.value = this.states.includes(state) ? normalizedXAxis : 0.5;\n        break;\n\n      case MotionControllerConstants.ComponentProperty.Y_AXIS:\n        this.value = this.states.includes(state) ? normalizedYAxis : 0.5;\n        break;\n\n      case MotionControllerConstants.ComponentProperty.BUTTON:\n        this.value = this.states.includes(state) && button ? button : 0;\n        break;\n\n      case MotionControllerConstants.ComponentProperty.STATE:\n        if (this.valueNodeProperty === MotionControllerConstants.VisualResponseProperty.VISIBILITY) {\n          this.value = this.states.includes(state);\n        } else {\n          this.value = this.states.includes(state) ? 1.0 : 0.0;\n        }\n\n        break;\n\n      default:\n        throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`);\n    }\n  }\n\n}\n\nclass Component {\n  /**\n   * @param {string} componentId - Id of the component\n   * @param {InputProfileComponent} componentDescription - Description of the component to be created\n   */\n  constructor(componentId, componentDescription) {\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"values\", void 0);\n\n    _defineProperty(this, \"type\", void 0);\n\n    _defineProperty(this, \"gamepadIndices\", void 0);\n\n    _defineProperty(this, \"rootNodeName\", void 0);\n\n    _defineProperty(this, \"visualResponses\", void 0);\n\n    _defineProperty(this, \"touchPointNodeName\", void 0);\n\n    _defineProperty(this, \"touchPointNode\", void 0);\n\n    if (!componentId || !componentDescription || !componentDescription.visualResponses || !componentDescription.gamepadIndices || Object.keys(componentDescription.gamepadIndices).length === 0) {\n      throw new Error('Invalid arguments supplied');\n    }\n\n    this.id = componentId;\n    this.type = componentDescription.type;\n    this.rootNodeName = componentDescription.rootNodeName;\n    this.touchPointNodeName = componentDescription.touchPointNodeName; // Build all the visual responses for this component\n\n    this.visualResponses = {};\n    Object.keys(componentDescription.visualResponses).forEach(responseName => {\n      const visualResponse = new VisualResponse(componentDescription.visualResponses[responseName]);\n      this.visualResponses[responseName] = visualResponse;\n    }); // Set default values\n\n    this.gamepadIndices = Object.assign({}, componentDescription.gamepadIndices);\n    this.values = {\n      state: MotionControllerConstants.ComponentState.DEFAULT,\n      button: this.gamepadIndices.button !== undefined ? 0 : undefined,\n      xAxis: this.gamepadIndices.xAxis !== undefined ? 0 : undefined,\n      yAxis: this.gamepadIndices.yAxis !== undefined ? 0 : undefined\n    };\n  }\n\n  get data() {\n    const data = {\n      id: this.id,\n      ...this.values\n    };\n    return data;\n  }\n  /**\n   * @description Poll for updated data based on current gamepad state\n   * @param {Object} gamepad - The gamepad object from which the component data should be polled\n   */\n\n\n  updateFromGamepad(gamepad) {\n    // Set the state to default before processing other data sources\n    this.values.state = MotionControllerConstants.ComponentState.DEFAULT; // Get and normalize button\n\n    if (this.gamepadIndices.button !== undefined && gamepad.buttons.length > this.gamepadIndices.button) {\n      const gamepadButton = gamepad.buttons[this.gamepadIndices.button];\n      this.values.button = gamepadButton.value;\n      this.values.button = this.values.button < 0 ? 0 : this.values.button;\n      this.values.button = this.values.button > 1 ? 1 : this.values.button; // Set the state based on the button\n\n      if (gamepadButton.pressed || this.values.button === 1) {\n        this.values.state = MotionControllerConstants.ComponentState.PRESSED;\n      } else if (gamepadButton.touched || this.values.button > MotionControllerConstants.ButtonTouchThreshold) {\n        this.values.state = MotionControllerConstants.ComponentState.TOUCHED;\n      }\n    } // Get and normalize x axis value\n\n\n    if (this.gamepadIndices.xAxis !== undefined && gamepad.axes.length > this.gamepadIndices.xAxis) {\n      this.values.xAxis = gamepad.axes[this.gamepadIndices.xAxis];\n      this.values.xAxis = this.values.xAxis < -1 ? -1 : this.values.xAxis;\n      this.values.xAxis = this.values.xAxis > 1 ? 1 : this.values.xAxis; // If the state is still default, check if the xAxis makes it touched\n\n      if (this.values.state === MotionControllerConstants.ComponentState.DEFAULT && Math.abs(this.values.xAxis) > MotionControllerConstants.AxisTouchThreshold) {\n        this.values.state = MotionControllerConstants.ComponentState.TOUCHED;\n      }\n    } // Get and normalize Y axis value\n\n\n    if (this.gamepadIndices.yAxis !== undefined && gamepad.axes.length > this.gamepadIndices.yAxis) {\n      this.values.yAxis = gamepad.axes[this.gamepadIndices.yAxis];\n      this.values.yAxis = this.values.yAxis < -1 ? -1 : this.values.yAxis;\n      this.values.yAxis = this.values.yAxis > 1 ? 1 : this.values.yAxis; // If the state is still default, check if the yAxis makes it touched\n\n      if (this.values.state === MotionControllerConstants.ComponentState.DEFAULT && Math.abs(this.values.yAxis) > MotionControllerConstants.AxisTouchThreshold) {\n        this.values.state = MotionControllerConstants.ComponentState.TOUCHED;\n      }\n    } // Update the visual response weights based on the current component data\n\n\n    Object.values(this.visualResponses).forEach(visualResponse => {\n      visualResponse.updateFromComponent(this.values);\n    });\n  }\n\n}\n/**\n * @description Builds a motion controller with components and visual responses based on the\n * supplied profile description. Data is polled from the xrInputSource's gamepad.\n * @author Nell Waliczek / https://github.com/NellWaliczek\n */\n\n\nclass MotionController {\n  /**\n   * @param {XRInputSource} xrInputSource - The XRInputSource to build the MotionController around\n   * @param {Profile} profile - The best matched profile description for the supplied xrInputSource\n   * @param {string} assetUrl\n   */\n  constructor(xrInputSource, profile, assetUrl) {\n    _defineProperty(this, \"xrInputSource\", void 0);\n\n    _defineProperty(this, \"assetUrl\", void 0);\n\n    _defineProperty(this, \"layoutDescription\", void 0);\n\n    _defineProperty(this, \"id\", void 0);\n\n    _defineProperty(this, \"components\", void 0);\n\n    if (!xrInputSource) {\n      throw new Error('No xrInputSource supplied');\n    }\n\n    if (!profile) {\n      throw new Error('No profile supplied');\n    }\n\n    if (!profile.layouts[xrInputSource.handedness]) {\n      throw new Error('No layout for ' + xrInputSource.handedness + ' handedness');\n    }\n\n    this.xrInputSource = xrInputSource;\n    this.assetUrl = assetUrl;\n    this.id = profile.profileId; // Build child components as described in the profile description\n\n    this.layoutDescription = profile.layouts[xrInputSource.handedness];\n    this.components = {};\n    Object.keys(this.layoutDescription.components).forEach(componentId => {\n      const componentDescription = this.layoutDescription.components[componentId];\n      this.components[componentId] = new Component(componentId, componentDescription);\n    }); // Initialize components based on current gamepad state\n\n    this.updateFromGamepad();\n  }\n\n  get gripSpace() {\n    return this.xrInputSource.gripSpace;\n  }\n\n  get targetRaySpace() {\n    return this.xrInputSource.targetRaySpace;\n  }\n  /**\n   * @description Returns a subset of component data for simplified debugging\n   */\n\n\n  get data() {\n    const data = [];\n    Object.values(this.components).forEach(component => {\n      data.push(component.data);\n    });\n    return data;\n  }\n  /**\n   * @description Poll for updated data based on current gamepad state\n   */\n\n\n  updateFromGamepad() {\n    Object.values(this.components).forEach(component => {\n      component.updateFromGamepad(this.xrInputSource.gamepad);\n    });\n  }\n\n}\n\nexport { MotionController, MotionControllerConstants, fetchProfile, fetchProfilesList };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}